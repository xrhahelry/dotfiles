#+title: Doom emacs config

* Set theme, font and line numbers
#+begin_src emacs-lisp
(setq doom-theme 'doom-one)
(setq display-line-numbers-type 'relative)
(setq doom-font (font-spec :family "IosevkaTerm Nerd Font" :size 20 :weight 'medium)
      doom-variable-pitch-font (font-spec :family "JetBrainsMono" :size 15 :weight 'light)
      doom-big-font (font-spec :family "Iosevka Nerd Font" :size 30))
(after! doom-themes
  (setq doom-themes-enable-bold t
        doom-themes-enable-italic t))
(custom-set-faces!
  '(font-lock-comment-face :slant italic)
  '(font-lock-keyword-face :slant italic))
#+end_src
* Splits and tab width
#+begin_src emacs-lisp
(setq-default tab-width 4)
(setq-default evil-shift-width tab-width)
(defun prefer-horizontal-split ()
  (set-variable 'split-height-threshold nil t)
  (set-variable 'split-width-threshold 40 t)) ; make this as low as needed
(add-hook 'markdown-mode-hook 'prefer-horizontal-split)
#+end_src
* Keybindings
** Set jk to esc
#+begin_src emacs-lisp
(setq evil-escape-key-sequence "jk"
      evil-escape-delay 0.2)
(evil-escape-mode 1)
#+end_src
** Line movement
#+begin_src emacs-lisp
(define-key evil-normal-state-map (kbd "H") (kbd "^"))
(define-key evil-normal-state-map (kbd "L") (kbd "$"))
(define-key evil-visual-state-map (kbd "H") (kbd "^"))
(define-key evil-visual-state-map (kbd "L") (kbd "$"))
#+end_src
** Evaluating lisp expressions
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("e". "evaluate")
       :desc "Evaluate elisp in buffer"  "b" #'eval-buffer
       :desc "Evaluate defun"            "d" #'eval-defun
       :desc "Evaluate elisp expression" "e" #'eval-expression
       :desc "Evaluate last sexpression" "l" #'eval-last-sexp
       :desc "Evaluate elisp in region"  "r" #'eval-region))
#+end_src
* Doom Modeline
#+begin_src emacs-lisp
(set-face-attribute 'mode-line nil :font "JetBrainsMono" :height 0.9)
(setq doom-modeline-height 35
      doom-modeline-bar-width 5
      doom-modeline-modal nil
      doom-modeline-buffer-file-name-style 'truncate-upto-project
      doom-modeline-project-detection 'project
      doom-modeline-persp-name t
      doom-modeline-persp-icon t
      doom-modeline-buffer-modification-icon t
      doom-modeline-modal-icon nil)
#+end_src
* Org Mode
** Basic Config
#+begin_src emacs-lisp
(after! org
  (setq inhibit-compacting-font-caches t)
  (custom-set-faces
    '(org-level-1 ((t (:inherit outline-1 :height 1.5 :family "JetBrainsMono"))))
    '(org-level-2 ((t (:inherit outline-2 :height 1.4 :family "JetBrainsMono"))))
    '(org-level-3 ((t (:inherit outline-3 :height 1.3 :family "JetBrainsMono"))))
    '(org-level-4 ((t (:inherit outline-4 :height 1.2 :family "JetBrainsMono"))))
    '(org-level-5 ((t (:inherit outline-5 :height 1.1 :family "JetBrainsMono"))))
    '(org-level-6 ((t (:inherit outline-6 :height 1.0 :family "JetBrainsMono"))))
    '(org-level-7 ((t (:inherit outline-7 :height 1.0 :family "JetBrainsMono"))))
    '(org-level-8 ((t (:inherit outline-8 :height 1.0 :family "JetBrainsMono")))))
  (setq org-directory "~/org/"
        org-default-notes-file (expand-file-name "notes.org" org-directory)
        org-ellipsis " ▼ "))
  (use-package! org-bullets
  :after org
  :hook (org-mode . org-bullets-mode)
  :config
  (setq org-bullets-bullet-list '("◉" "●" "◆" "○" "●" "◆" "○")))
#+end_src
** Org Roam
#+begin_src emacs-lisp
(after! org
  (setq org-roam-directory "~/org/roam/"
        org-roam-graph-viewer "/usr/bin/firefox"))

(map! :leader
      (:prefix ("n r" . "org-roam")
       :desc "Completion at point" "c" #'completion-at-point
       :desc "Find node"           "f" #'org-roam-node-find
       :desc "Show graph"          "g" #'org-roam-graph
       :desc "Insert node"         "i" #'org-roam-node-insert
       :desc "Capture to node"     "n" #'org-roam-capture
       :desc "Toggle roam buffer"  "r" #'org-roam-buffer-toggle))
#+end_src
** Org Agenda
#+begin_src emacs-lisp
(after! org
  (setq org-agenda-files '("~/org/agenda.org")))
#+end_src
* Dired Mode
#+begin_src emacs-lisp
(map! :leader
      (:prefix ("d" . "dired")
       :desc "Open dired" "d" #'dired
       :desc "Dired jump to current" "j" #'dired-jump)
      (:after dired
       (:map dired-mode-map
        :desc "Peep-dired image previews" "d p" #'peep-dired
        :desc "Dired view file"           "d v" #'dired-view-file)))
(evil-define-key 'normal dired-mode-map
  (kbd "M-RET") 'dired-display-file
  (kbd "h") 'dired-up-directory
  (kbd "l") 'dired-find-file ; use dired-find-file instead of dired-open.
  (kbd "m") 'dired-mark
  (kbd "t") 'dired-toggle-marks
  (kbd "u") 'dired-unmark
  (kbd "C") 'dired-do-copy
  (kbd "D") 'dired-do-delete
  (kbd "J") 'dired-goto-file
  (kbd "M") 'dired-do-chmod
  (kbd "O") 'dired-do-chown
  (kbd "P") 'dired-do-print
  (kbd "R") 'dired-do-rename
  (kbd "T") 'dired-do-touch
  (kbd "Y") 'dired-copy-filenamecopy-filename-as-kill ; copies filename to kill ring.
  (kbd "Z") 'dired-do-compress
  (kbd "+") 'dired-create-directory
  (kbd "-") 'dired-do-kill-lines
  (kbd "% l") 'dired-downcase
  (kbd "% m") 'dired-mark-files-regexp
  (kbd "% u") 'dired-upcase
  (kbd "* %") 'dired-mark-files-regexp
  (kbd "* .") 'dired-mark-extension
  (kbd "* /") 'dired-mark-directories
  (kbd "; d") 'epa-dired-do-decrypt
  (kbd "; e") 'epa-dired-do-encrypt)
#+end_src
